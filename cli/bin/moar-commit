#!/bin/bash

set -e

if ! [ "$1" != "" ]; then
  echo 'Required'
  echo '$1 -- Message'
fi

for module in ~/modules/*; do
  cd $module
  status="$(git status --short 2> /dev/null | wc -l | sed 's/ //g' || true)"
  if [ "$status" != "0" ]; then
    echo $(basename $module)
    git add -A
    git commit -m "$1" | grep 'files changed'
  fi
done
